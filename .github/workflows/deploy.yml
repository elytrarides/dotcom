name: github pages

on:
    push:
        branches:
            - main # Set a branch to deploy
    pull_request:

jobs:
    deploy:
        runs-on: ubuntu-20.04
        permissions:
          contents: write
        steps:
            - uses: actions/checkout@v2
              with:
                persist-credentials: false
            - name: Setup Node
              uses: actions/setup-node@v1
              with:
                  node-version: 16
                  registry-url: https://registry.npmjs.org/
            - name: Install Deps
              run: yarn
            - name: Build
              run: yarn build
            - name: Add CNAME
              run: echo elytrarides.com>public/CNAME
            - name: Deploy
              uses: JamesIves/github-pages-deploy-action@3.7.1
              with:
                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
                  BRANCH: gh-pages # The branch the action should deploy to.
                  FOLDER: build # The folder the action should deploy.
                  CLEAN: true # Automatically remove deleted files from the deploy branch
